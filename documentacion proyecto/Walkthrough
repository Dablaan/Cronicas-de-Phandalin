# Walkthrough: Estado Actual del Proyecto üõ°Ô∏è

## Resumen de Implementaciones Completadas

### 1. Estado y Sincronizaci√≥n (`state.js`)
- **Merge Inteligente**: `state.update()` hace `storageAdapter.load()` antes de guardar. Jugadores solo patchean su propio PJ en la lista remota, protegiendo datos del DM y otros jugadores
- **Guardado Silencioso**: par√°metro `skipNotify` evita re-renders innecesarios (ej: botones HP)
- **Edit Mode Guard**: `window.isSheetEditMode` bloquea updates remotos durante edici√≥n activa

### 2. Sistema de Autenticaci√≥n (`auth.js`)
- DM: password fija ‚Üí `state.update({ session })` ‚Üí `switchTab('tab-dashboard')`
- Jugadores: selecci√≥n de PJ ‚Üí modal Cerrojo M√°gico ‚Üí `switchTab('tab-ficha')`
- Logout: reinicia sesi√≥n sin eliminar datos

### 3. Motor de UI (`ui.js` ‚Äî 2448 l√≠neas, 95 funciones)
- **Ficha de PJ**: stats, HP interactivo, saves, skills, ataques CRUD, inventario, grimorio
- **NPCs/Mapas**: CRUD via modal unificado (`openEntityModal`), subida de im√°genes a Supabase Storage
- **Bestiario**: Stat Blocks D&D 5e con auto-c√°lculo de modificadores
- **Encuentros**: Combat Builder con selector m√∫ltiple de monstruos + bot√≠n
- **Biblioteca**: Grid visual de portadas con CRUD

### 4. Dise√±o Visual (`styles.css` ‚Äî 1407 l√≠neas)
- Sistema `.card-horizontal` responsivo: desktop horizontal (100px img) / mobile horizontal reducido (80px img)
- Biblioteca en grid 3 columnas (desktop) / 2 (mobile)
- Variables CSS tem√°ticas (pergamino, cuero, oro, tinta roja)

## M√©tricas del C√≥digo

| Fichero | L√≠neas | Funciones |
|---|---|---|
| `ui.js` | 2448 | 95 |
| `styles.css` | 1407 | ‚Äî |
| `index.html` | 204 | ‚Äî |
| `state.js` | 138 | 5 |
| `storageAdapter.js` | 137 | 5 |
| `auth.js` | 55 | 1 (export) |
| `main.js` | 31 | 1 (bootstrap) |

> [!TIP]
> Para probar concurrencia, abre dos pesta√±as (DM + Jugador) y edita simult√°neamente. El merge inteligente protege ambas sesiones.
